version: 2

models:
  - name: stg_src_local_bike_stores
    description: "Store locations in California, New York, and Texas."
    columns:
      - name: store_id
        description: "Primary key, unique identifier for each store."
        tests:
          - unique
          - not_null
      - name: store_email
        tests:
          - not_null
  - name: stg_src_local_bike_brands
    description: "Bike brands sold by Local Bike."
    columns:
      - name: brand_id
        description: "Primary key, unique identifier for each brand."
        tests:
          - unique
          - not_null
  - name: stg_src_local_bike_customers
    description: "Customer informations."
    columns:
      - name: customer_id
        description: "Primary key, unique identifier for each brand."
        tests:
          - unique
          - not_null
      - name: customer_email
        tests:
          - not_null
  - name: stg_src_local_bike_orders
    description: "Order headers with key dates and statuses"
    columns:
      - name: order_id
        description: "Primary key, unique identifier for each order."
        tests:
          - unique
          - not_null
      - name: customer_id
        tests:
          - relationships:
              arguments:
                to: ref('stg_src_local_bike_customers')
                field: customer_id
      - name: store_id
        tests:
          - relationships:
              arguments:
                to: ref('stg_src_local_bike_stores')
                field: store_id
      - name: staff_id
        tests:
          - relationships:
              arguments:
                to: ref('stg_src_local_bike_staffs')
                field: staff_id
  - name: stg_src_local_bike_products
    description: "Products sold, linked to brands and categories."
    columns:
      - name: product_id
        description: "Primary key, unique identifier for each product."
        tests:
          - unique
          - not_null
      - name: brand_id
        tests:
          - relationships:
              arguments:
                to: ref('stg_src_local_bike_brands')
                field: brand_id
      - name: category_id                
        tests:
          - relationships:
              arguments:
                to: ref('stg_src_local_bike_categories')
                field: category_id                          
  - name: stg_src_local_bike_staffs
    description: "Sales and management staff working in Local Bike stores."
    columns:
      - name: staff_id
        description: "Primary key, unique identifier for each staff."
        tests:
          - unique
          - not_null         
      - name: staff_email
        tests:
          - not_null
      - name: store_id
        tests:
          - relationships:
              arguments:
                to: ref('stg_src_local_bike_stores')
                field: store_id              
  - name: stg_src_local_bike_categories
    description: "Product categories such as road, mountain, and electric bikes."
    columns:
      - name: category_id
        description: "Primary key, unique identifier for each category."
        tests:
          - unique
          - not_null
  - name: stg_src_local_bike_order_items
    description: "Detailed order line items with pricing and discounts."
    columns:
      - name: order_id
        description: "Primary key, composite key with item_id"
        tests:
          - not_null
      - name: item_id
        description: "Primary key, composite key with order_id"
        tests:
          - not_null          
      - name: product_id
        tests:
          - relationships:
              arguments:
                to: ref('stg_src_local_bike_products')
                field: product_id
      - name: total_item_discount_sold
        description: "quantity * list_price * (1 - discount)"  
        tests:
          - not_null
  - name: stg_src_local_bike_stocks
    description: "Stock of products and availability."
    columns:
      - name: store_id
        description: "Primary key, composite key with product_id."
        tests:
          - not_null
      - name: product_id
        description: "Primary key, composite key with store_id."
        tests:
          - not_null          
      - name: product_id
        tests:
          - relationships:
              arguments:
                to: ref('stg_src_local_bike_products')
                field: product_id           